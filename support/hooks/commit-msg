#!/usr/bin/env bash
#
# A git commit hook that check the DCO signoff.
#
# To enable this hook, run `bootstrap`, or run the following from the root of
# the repo. (Note that `bootstrap` will correctly install this even if this code
# is located in a submodule, while the following won't.)
#
# $ ln -s ../../support/hooks/commit-msg .git/hooks/commit-msg

COMMIT_MESSAGE_FILE="$1"
SIGNOFF="Signed-off-by:"

# Check for DCO signoff message. If one doesn't exist, warn the user.
if ! grep -qs "^$SIGNOFF" "$COMMIT_MESSAGE_FILE"; then
  echo -e "The commit doesn't have DCO signoff. Please ensure install the git hooks by './support/bootstrap'"
  exit 1
fi