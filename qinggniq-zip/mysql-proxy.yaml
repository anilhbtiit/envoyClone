static_resources:
  listeners:
    - address:
        socket_address:
          address: 0.0.0.0
          port_value: 9001
      filter_chains:
        - filters:
            - name: envoy.filters.network.mysql_proxy
              typed_config:
                "@type": type.googleapis.com/envoy.extensions.filters.network.mysql_proxy.v3.MySQLProxy
                stat_prefix: mysql
                downstream_auth_info:
                  username:
                    inline_string: "root"
                  password:
                    inline_string: "123"
                database_routes:
                  routes:
                    - database: "b"
                      cluster: cluster_b
                    - database: "a"
                      cluster: local_service
                  catch_all_route:
                    cluster: "local_service"
  clusters:
    - name: local_service
      connect_timeout: 0.25s
      typed_extension_protocol_options:
        envoy.filters.network.mysql_proxy:
          "@type": type.googleapis.com/envoy.extensions.filters.network.mysql_proxy.v3.MySQLProtocolOptions
          upstream_auth_info:
            username:
              inline_string: "root"
            password:
              inline_string: "123"
      type: strict_dns
      lb_policy: LEAST_REQUEST
      load_assignment:
        cluster_name: local_service
        endpoints:
          - lb_endpoints:
              - endpoint:
                  address:
                    socket_address:
                      address: 127.0.0.1
                      port_value: 8002
    - name: cluster_b
      connect_timeout: 0.25s
      typed_extension_protocol_options:
        envoy.filters.network.mysql_proxy:
          "@type": type.googleapis.com/envoy.extensions.filters.network.mysql_proxy.v3.MySQLProtocolOptions
          upstream_auth_info:
            username:
              inline_string: "root"
            password:
              inline_string: "123"
      type: strict_dns
      lb_policy: LEAST_REQUEST
      load_assignment:
        cluster_name: cluster_b
        endpoints:
          - lb_endpoints:
              - endpoint:
                  address:
                    socket_address:
                      address: 127.0.0.1
                      port_value: 8003
admin:
  access_log_path: "/dev/null"
  address:
    socket_address:
      address: 0.0.0.0
      port_value: 8081
