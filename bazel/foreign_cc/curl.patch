diff --git a/CMakeLists.txt b/CMakeLists.txt
index 68842ee3e..957e0b470 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -40 +40 @@
-cmake_minimum_required(VERSION 3.2...3.16 FATAL_ERROR)
+cmake_minimum_required(VERSION 3.2 FATAL_ERROR)
@@ -247,3 +247,6 @@ if(CURL_STATIC_CRT)
-  set(CMAKE_MSVC_RUNTIME_LIBRARY "MultiThreaded$<$<CONFIG:Debug>:Debug>")
-  set(CMAKE_C_FLAGS_RELEASE "${CMAKE_C_FLAGS_RELEASE} /MT")
-  set(CMAKE_C_FLAGS_DEBUG "${CMAKE_C_FLAGS_DEBUG} /MTd")
+  foreach (build_suffix "" _DEBUG _RELEASE _MINSIZEREL _RELWITHDEBINFO)
+    set (flags_var CMAKE_C_FLAGS_${build_suffix})
+    if ("${${flags_var}}" MATCHES "/MD")
+      string(REGEX REPLACE "/MD" "/MT" ${flags_var} "${${flags_var}}")
+    endif()
+  endforeach()
diff --git a/lib/CMakeLists.txt b/lib/CMakeLists.txt
index 1d71e1490..b85fcdcd6 100644
--- a/lib/CMakeLists.txt
+++ b/lib/CMakeLists.txt
@@ -100,4 +99,0 @@ add_library(
-if(MSVC AND NOT BUILD_SHARED_LIBS)
-  set_target_properties(${LIB_NAME} PROPERTIES STATIC_LIBRARY_FLAGS ${CMAKE_EXE_LINKER_FLAGS})
-endif()
-
