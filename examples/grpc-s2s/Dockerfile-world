FROM golang:1.19.3-bullseye as builder

WORKDIR /build

COPY world /build/world
COPY protos /build/protos

# Build for linux
ENV GOOS=linux
ENV GOARCH=amd64
ENV CGO_ENABLED=0

WORKDIR /build/world
RUN go build -o server

# Build the main container (Linux Runtime)
FROM debian:bullseye-slim
WORKDIR /root/

# Copy the linux amd64 binary
COPY --from=builder /build/world /bin/
